/*! yiqi_web 2016-12-30 */
!function(){"use strict";function a(a,b,c,d,e,f){function g(){var b={user_id:a.userInfo.id,review_sn:c.review_sn};d.getReviewDetail(b).success(function(a){return 200!=a.ret?(window.showAutoDialog(a.msg),!1):void(2e4==a.data.code?a.data.list?j.reviewInfo=a.data.list:(window.showAutoDialog("访问出错，可能表单未设置"),e.go("index")):(window.showAutoDialog(a.data.msg),e.go("index")))})}function h(){var b={user_id:a.userInfo.id,review_id:c.review_id};d.getProjectResultArray(b).success(function(a){return 200!=a.ret?(window.showAutoDialog(a.msg),!1):void(2e4==a.data.code?(j.projectArray=a.data.list,j.select_project_id=a.data.list[0].id,j.getReviewResult()):window.showAutoDialog(a.data.msg))})}function i(){var b={user_id:a.userInfo.id,review_id:c.review_id,project_id:j.select_project_id};a.$broadcast("public.show",["loading_panel"]),d.getReviewResult(b).success(function(b){try{if(200!=b.ret)return window.showAutoDialog(b.msg),!1;if(2e4==b.data.code){var c=b.data.project_name,d=b.data.all,e=b.data.user,g=b.data.list;if(0==j.loaded){j.loaded=!0;for(var h=j.projectArray.length,i=[],k=0;k<h;k++)i.push([]);for(var k=0;k<c.length;k++)for(var l=0;l<h;l++)c[k]==j.projectArray[l].project_name&&i[l].push({project_name:c[k],score:d[k]});!function(){for(var a=0,b=[],c=0;c<i.length;c++){for(var d=0,e=0;e<i[0].length;e++)d+=i[c][e].score;b[c]=d}if(j.maxScore=Math.max.apply(null,b),j.maxProjectName=i[b.indexOf(j.maxScore)][0].project_name,b.length<=2){for(var f=0;f<b.length;f++)a+=parseInt(b[f]);j.averageScore=a/b.length}else{for(var f=1;f<b.length-1;f++)a+=parseInt(b[f]);j.averageScore=a/(b.length-2)}}()}!function(){for(var a=[],b=0;b<g.length;b++)a.push({username:e[b],score:g[b]});j.resultScoreArray=a}()}else window.showAutoDialog(b.data.msg)}catch(a){console.log(a.message)}finally{f(function(){a.$broadcast("public.hide",["loading_panel"])},800)}})}angular.element(b).scrollTop(0),a.title="评审/评估结果";var j=this;"0"==c.type?j.title="评审结果":"1"==c.type&&(j.title="评估结果"),j.projectArray=[],j.select_project_id="",j.resultScoreArray=[],j.maxScore="--",j.maxProjectName="--",j.averageScore="--",j.loaded=!1,j.getReviewDetail=g,j.getProjectResultArray=h,j.getReviewResult=i,function(){return a.userInfo.id?(j.getReviewDetail(),void j.getProjectResultArray()):(e.go("login"),!1)}()}app.import("/app/Tpl/web/js/directive/mouseover.directive.js","ngMouseOver.directive"),app.import("/app/Tpl/web/js/service/service_min/examine.service.min.js","examine.service"),app.addController("examineResultController",a),a.$inject=["$rootScope","$window","$stateParams","examineService","$state","$timeout"]}();