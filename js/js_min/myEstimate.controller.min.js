/*! yiqi_web 2016-12-30 */
!function(){"use strict";function a(a,b,c,d,e,f,g){function h(){var c={pageSize:r.pageParams.pageSize,current:r.pageParams.current,user_id:a.userInfo.id,type:"1"};b.getExamineList(c).success(function(a){return 200!=a.ret?(window.showAutoDialog(a.msg),!1):void(2e4==a.data.code?(r.estimateArray=a.data.list,r.pageParams.page_count=a.data.page_count,r.loaded=!0):window.showAutoDialog(a.data.msg))})}function i(){return function(a){parseInt(a)>0&&parseInt(a)<=r.pageParams.page_count?(r.pageParams.current=parseInt(a),r.getEstimateList(),angular.element(d).scrollTop(0)):console.log("输入非法")}}function j(){if(window.clipboardData)angular.element(".copy-button").bind("click",function(a){var b=angular.element(this).attr("data-clipboard-text");window.clipboardData.setData("Text",b),window.showAlertTip("复制完成")});else{var a=new ZeroClipboard(document.getElementsByClassName("copy-button"));a.on("ready",function(b){a.on("aftercopy",function(a){window.showAlertTip("复制成功")})})}}function k(b){if(!r.flag.openFlag)return!1;var c={user_id:a.userInfo.id,review_sn:b};a.$broadcast("public.show",["loading_panel"]),r.flag.openFlag=!1,f.open(c).success(function(b){try{if(200!=b.ret)return window.showAutoDialog(b.msg),!1;2e4==b.data.code?e.reload():window.showAutoDialog(b.data.msg)}catch(a){}finally{r.flag.openFlag=!0,a.$broadcast("public.hide",["loading_panel"])}})}function l(b){r.select_review_sn=b;var c={alertDialogTitle:"确定结束评分吗？",alertDialogConfirm:r.closeDialogConfirm,alertDialogCancel:null,alertDialogCancelButton:!0};a.$broadcast("public.showAlertDialog",c)}function m(){if(!r.flag.closeFlag)return!1;a.$broadcast("public.hide",[]);var b={user_id:a.userInfo.id,review_sn:r.select_review_sn};a.$broadcast("public.show",["loading_panel"]),r.flag.closeFlag=!1,f.close(b).success(function(b){try{if(200!=b.ret)return window.showAutoDialog(b.msg),!1;2e4==b.data.code?e.reload():window.showAutoDialog(b.data.msg)}catch(a){}finally{r.flag.openFlag=!0,a.$broadcast("public.hide",["loading_panel"])}})}function n(b){if(!r.flag.getReportPriceFlag)return!1;var c={type:b};r.flag.getReportPriceFlag=!1,a.$broadcast("public.show",["loading_panel"]),f.getReportPrice(c).success(function(b){try{if(200!=b.ret)return window.showAutoDialog(b.msg),!1;2e4==b.data.code?r.reportPrice=b.data.price.price:window.showAutoDialog(b.data.msg)}catch(a){}finally{a.$broadcast("public.hide",["loading_panel"]),r.flag.getReportPriceFlag=!0}})}function o(b){return a.userInfo.id?(r.selectReviewSn=b,r.editReportDialog=!0,void console.log(r.selectReviewId)):(window.showAutoDialog("请先登录"),!1)}function p(){if(!r.flag.setReportOrderFlag)return!1;var b={type:r.selectReportType,user_id:a.userInfo.id,review_sn:r.selectReviewSn};a.$broadcast("public.show",["loading_panel"]),r.flag.setReportOrderFlag=!1,f.setReportOrder(b).success(function(b){try{200!=b.ret?window.showAutoDialog(b.msg):2e4==b.data.code?e.go("payMoney",{id:b.data.order_info.order_sn,price:b.data.order_info.price,num:"1",Project_type:"2",url:"personal.myEstimate"}):window.showAutoDialog(b.data.msg)}catch(a){}finally{a.$broadcast("public.hide",["loading_panel"]),r.flag.setReportOrderFlag=!0,r.editReportDialog=!1}})}function q(){r.editReportDialog=!1}a.title="我的评估";var r=this;r.baseUrl=g.host(),r.pageParams={showPage:5,pageSize:10,current:1,page_count:22,pageChange:i},r.estimateArray=[],r.flag={openFlag:!0,closeFlag:!0,getReportPriceFlag:!0,setReportOrderFlag:!0},r.editReportDialog=!1,r.selectReportType="0",r.getEstimate=h,r.setCopy=j,r.open=k,r.closeDialog=l,r.closeDialogConfirm=m,r.getReportPrice=n,r.showDialog=o,r.alertDialogConfirm=p,r.alertDialogCancel=q,function(){r.getEstimate(),r.getReportPrice("0")}()}app.import("/app/Tpl/web/js/directive/pagebar.directive.js","pagebar.directive"),app.import("/app/Tpl/web/js/service/service_min/examine.service.min.js","examine.service"),app.import("/app/Tpl/web/js/directive/repeatDone.directive.js","repeatDone.directive"),app.addController("myEstimateController",a),a.$inject=["$rootScope","personalService","$filter","$window","$state","examineService","$location"]}();